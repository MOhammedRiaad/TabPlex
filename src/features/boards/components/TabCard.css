/* ============================================
   ANIMATION KEYFRAMES
   ============================================ */

@keyframes slideInUp {
    0% {
        opacity: 0;
        transform: translateY(15px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes bounceIn {
    0% {
        transform: scale(0.95);
        opacity: 0;
    }

    60% {
        transform: scale(1.02);
        opacity: 1;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes dragGlow {
    0%,
    100% {
        box-shadow:
            0 8px 25px rgba(0, 0, 0, 0.15),
            0 0 0 2px rgba(59, 130, 246, 0.3);
    }

    50% {
        box-shadow:
            0 12px 30px rgba(0, 0, 0, 0.2),
            0 0 0 3px rgba(59, 130, 246, 0.5);
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .tab-card,
    .tab-card * {
        animation: none !important;
        transition-duration: 0.01ms !important;
    }
}

/* ============================================
   TAB CARD STYLES
   ============================================ */

.tab-card {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    background-color: var(--color-bg-primary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: default;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    min-height: 48px;
    animation: slideInUp 0.3s ease-out backwards;
    animation-delay: calc(var(--card-index, 0) * 0.04s);
}

.tab-card:hover {
    background-color: var(--color-bg-secondary);
    border-color: var(--color-border-focus);
    transform: translateY(-3px) scale(1.01);
    box-shadow:
        0 6px 20px rgba(0, 0, 0, 0.08),
        0 0 0 1px rgba(59, 130, 246, 0.1);
}

.tab-card.dragging {
    opacity: 1;
    z-index: 1000 !important;
    transform: rotate(2deg) scale(1.02);
    animation: dragGlow 1s ease-in-out infinite;
    border-color: var(--color-primary);
    background-color: var(--color-bg-secondary);
}

/* Header area: Drag handle is now integrated seamlessly */
.drag-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-muted);
    cursor: grab;
    padding: var(--spacing-xs);
    border-radius: var(--radius-sm);
    opacity: 0;
    /* Hidden by default for cleaner look */
    transition: opacity var(--transition-fast);
    font-size: 14px;
}

.tab-card:hover .drag-handle {
    opacity: 0.5;
}

.drag-handle:hover {
    opacity: 1 !important;
    background-color: var(--color-bg-tertiary);
}

.drag-handle:active {
    cursor: grabbing;
}

.tab-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    flex-shrink: 0;
    border-radius: var(--radius-sm);
    background-color: var(--color-bg-tertiary);
    padding: 2px;
}

.tab-icon img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 2px;
}

.default-icon {
    font-size: 14px;
}

/* Content Area */
.tab-content {
    flex: 1;
    min-width: 0;
    /* Important for truncation */
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 2px;
    padding-right: var(--spacing-xs);
    /* Separation from actions */
}

.tab-title {
    margin: 0;
    font-size: var(--font-sm);
    font-weight: 500;
    color: var(--color-text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.2;
}

.tab-url {
    margin: 0;
    font-size: 11px;
    /* Slightly smaller */
    color: var(--color-text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    opacity: 0.8;
}

/* Actions: Now Static Flex Items (No Overlap) */
.tab-actions {
    display: flex;
    align-items: center;
    gap: 2px;
    opacity: 0;
    /* Hidden until hover */
    transform: translateX(10px);
    transition: all var(--transition-fast);
    flex-shrink: 0;
    /* Don't squash */
}

.tab-card:hover .tab-actions {
    opacity: 1;
    transform: translateX(0);
}

.edit-btn,
.delete-btn {
    background: transparent;
    border: none;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--color-text-secondary);
    transition: all var(--transition-fast);
    font-size: 14px;
}

.edit-btn:hover {
    background-color: var(--color-bg-tertiary);
    color: var(--color-primary);
}

.delete-btn:hover {
    background-color: rgba(239, 68, 68, 0.1);
    color: var(--color-danger);
}

/* Editing State */
.tab-card.editing {
    display: block;
    /* Switch back to block for form layout */
    padding: var(--spacing-md);
    border-color: var(--color-primary);
    box-shadow: 0 0 0 1px var(--color-primary, #3b82f6);
}

.tab-edit {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-sm);
}

.tab-card.editing .tab-header,
.tab-card.editing .tab-content {
    display: none;
    /* Hide standard view elements while editing */
}

/* But we might need the icon visible, let's adjust the component structure slightly if needed, 
   or just accept the form takes over. The current component renders the header even in edit mode. 
*/

/* Adjustments for the existing component structure compatibility */
.tab-card.editing .tab-header {
    display: flex;
    /* Keep header visible */
}

.tab-card.editing .tab-content {
    display: none;
    /* Hide normal content text */
}

.edit-title,
.edit-url {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
    font-size: 14px;
    transition: border-color var(--transition-fast);
}

.edit-title:focus,
.edit-url:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
}

.edit-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-xs);
}

.edit-actions button {
    padding: 6px 12px;
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.edit-actions button:first-child {
    /* Save */
    background-color: var(--color-primary);
    color: white;
    border: 1px solid var(--color-primary);
}

.edit-actions button:first-child:hover {
    background-color: var(--color-primary-hover);
}

.edit-actions button:nth-child(2) {
    /* Cancel */
    background-color: transparent;
    border: 1px solid var(--color-border);
    color: var(--color-text-primary);
}

.edit-actions button:nth-child(2):hover {
    background-color: var(--color-bg-tertiary);
}

.edit-actions .delete-btn {
    /* Delete in edit mode */
    margin-left: auto;
    /* Push to left? or stick with group */
    width: auto;
    height: auto;
    padding: 6px 12px;
    border: 1px solid transparent;
}

.tab-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.drag-handle {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 12px;
    height: 20px;
    cursor: grab;
    opacity: 0.5;
    padding: 2px;
    border-radius: 2px;
    font-size: var(--font-xs);
    line-height: 0.6rem;
    color: var(--color-text-muted);
    transition: all var(--transition-fast);
}

.drag-handle:hover {
    opacity: 1;
    background-color: var(--color-bg-tertiary);
}

.drag-handle:active {
    cursor: grabbing;
}

.tab-card.dragging {
    opacity: 0.8;
    z-index: 1000 !important;
    position: relative;
    box-shadow: var(--shadow-lg);
}

.tab-card:hover {
    background-color: var(--color-bg-secondary);
    border-color: var(--color-border-focus);
}

.tab-card.editing {
    flex-direction: column;
    gap: var(--spacing-sm);
}

.tab-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.tab-icon img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.default-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    font-size: var(--font-sm);
}

.tab-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    position: relative;
}

.tab-title {
    margin: 0 0 var(--spacing-xs) 0;
    font-size: var(--font-sm);
    font-weight: 500;
    color: var(--color-text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.tab-url {
    margin: 0 0 var(--spacing-sm) 0;
    font-size: var(--font-xs);
    color: var(--color-text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.tab-actions {
    position: absolute;
    top: 0;
    right: 0;
    display: none;
}

.tab-card:hover .tab-actions {
    display: flex;
    gap: var(--spacing-xs);
}

.edit-btn {
    background: none;
    border: none;
    font-size: var(--font-xs);
    cursor: pointer;
    padding: 2px;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
}

.edit-btn:hover {
    background-color: var(--color-bg-tertiary);
}

.delete-btn {
    background: none;
    border: none;
    font-size: var(--font-xs);
    cursor: pointer;
    padding: 2px;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
}

.delete-btn:hover {
    background-color: rgba(239, 68, 68, 0.1);
    color: var(--color-danger);
}

.tab-edit {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.tab-edit input {
    width: 100%;
    padding: var(--spacing-xs);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: var(--font-sm);
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
}

.tab-edit input:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
}

.edit-title {
    font-weight: 500;
}

.edit-actions {
    display: flex;
    gap: var(--spacing-xs);
    justify-content: flex-end;
    margin-top: var(--spacing-xs);
}

.edit-actions button {
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background-color: var(--color-bg-primary);
    cursor: pointer;
    font-size: var(--font-xs);
    color: var(--color-text-secondary);
    transition: all var(--transition-fast);
}

.edit-actions button:hover {
    background-color: var(--color-bg-tertiary);
}
